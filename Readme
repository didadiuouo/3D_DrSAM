3D_DrSAM 

DrSAM3D对比算法   位置：D:\Desktop\3D_segmentation\3D-DRSAM\2. SAM3d-consist

DrSAM3D结合了一个基于U-Net的深度学习模型（LumoDiscNet, LDN）和一个预训练的图像分割模型（SAM 3D），以提高脊椎间盘分割的准确性。LDN提供初步的分割结果，作为SAM 3D的提示，引导SAM 3D进行更精确的分割。

Run 3D_DrSAm.py
	输出结果平均DICE，IOU
	每2epoch输出3D分割结果

表1 DRSAM3D分割指标
Class	DICE	IOU
Class 0	0.9864	0.9731
Class 1	0.8371	0.7204
Class 2	0.8449	0.7336
Class 3	0.8508	0.7420
Class 4	0.8408	0.7269
Class 5	0.8427	0.7293
Class 6	0.8030	0.6885
Class 7	0.7703	0.6614
Class 8	0.6803	0.5359
Class 9	0.3398	0.2147
Class 10	0.7099	0.5503
Class 11	0.8195	0.6994
Class 12	0.8388	0.7346
Class 13	0.8693	0.7706
Class 14	0.8724	0.7753
Class 15	0.8618	0.7621
Class 16	0.7896	0.6922
Class 17	0.7642	0.6429
Class 18	0.7287	0.5800
Class 19	0.6484	0.4798
Average_All	0.7849	0.6706


DrSAM3D/
      │
      └── 3D_DrSAM_end/
               ├──checkpoint     #权重保存
               │
               ├── output           #推理图像输出
               │
	       ├── segement_anything_3d        #SAM3D权重及文件
               │
               ├── utils                   #数据处理函数
               │
               └──3D_DrSAM         #DrSAM3D主函数      

Usage
train

数据集地址
#图像地址->标签地址->推理输出地址->权重保存地址
    image_dir = '/Data/VesselFM/dataset/imagesTr'
    label_dir = '/Data/VesselFM/dataset/labelsTr'
    output_dir = '/Data/VesselFM/3D_DrSAM_unet/output_0808'
    checkpoint = '/Data/VesselFM/FastSAM3D/ckpt/sam_med3d.pth'

Train and evaluate the model:
	python 3D_DrSAM.py





